<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Inês Silva">
<meta name="dcterms.date" content="2025-06-20">
<meta name="description" content="Guide to autocorrelated home range estimation using R">
<title>How to estimate home ranges – Inês Silva</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//static/logo_favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-34afa9cd112b715c69edd3663dee34db.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../assets/styles.css">
<meta property="og:title" content="How to estimate home ranges – Inês Silva">
<meta property="og:description" content="Guide to autocorrelated home range estimation using R">
<meta property="og:image" content="https://ecoisilva.github.io//files/blog-image1.png">
<meta property="og:site_name" content="Inês Silva">
<meta property="og:locale" content="en_US">
<meta name="twitter:title" content="How to estimate home ranges – Inês Silva">
<meta name="twitter:description" content="Guide to autocorrelated home range estimation using R">
<meta name="twitter:image" content="https://ecoisilva.github.io//files/blog-image1.png">
<meta name="twitter:creator" content="@ecoisilva">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../static/logo_favicon.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Inês Silva</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../content/publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../content/software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../content/about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://www.github.com/ecoisilva" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li>
<a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
<li>
<a href="#step-1.-formatting-and-loading-an-animal-tracking-dataset" id="toc-step-1.-formatting-and-loading-an-animal-tracking-dataset" class="nav-link" data-scroll-target="#step-1.-formatting-and-loading-an-animal-tracking-dataset"><strong>Step 1.</strong> Formatting and loading an animal tracking dataset</a>
  <ul class="collapse">
<li><a href="#buffalo-tracking-data" id="toc-buffalo-tracking-data" class="nav-link" data-scroll-target="#buffalo-tracking-data">1.1. Buffalo tracking data</a></li>
  <li><a href="#gazelle-tracking-data" id="toc-gazelle-tracking-data" class="nav-link" data-scroll-target="#gazelle-tracking-data">1.2. Gazelle tracking data</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a>
  <ul class="collapse">
<li><a href="#step-2.-checking-for-the-range-residency-assumption" id="toc-step-2.-checking-for-the-range-residency-assumption" class="nav-link" data-scroll-target="#step-2.-checking-for-the-range-residency-assumption"><strong>Step 2.</strong> Checking for the <em>range residency</em> assumption</a></li>
  <li><a href="#step-3.-selecting-the-best-fit-movement-model-through-model-selection" id="toc-step-3.-selecting-the-best-fit-movement-model-through-model-selection" class="nav-link" data-scroll-target="#step-3.-selecting-the-best-fit-movement-model-through-model-selection"><strong>Step 3.</strong> – Selecting the best-fit movement model through <em>model selection</em></a></li>
  <li><a href="#step-4.-feeding-a-movement-model-into-the-home-range-estimator" id="toc-step-4.-feeding-a-movement-model-into-the-home-range-estimator" class="nav-link" data-scroll-target="#step-4.-feeding-a-movement-model-into-the-home-range-estimator"><strong>Step 4.</strong> Feeding a movement model into the <em>home range estimator</em></a></li>
  <li>
<a href="#step-5.-evaluating-additional-biases-applying-mitigation-measures" id="toc-step-5.-evaluating-additional-biases-applying-mitigation-measures" class="nav-link" data-scroll-target="#step-5.-evaluating-additional-biases-applying-mitigation-measures"><strong>Step 5.</strong> Evaluating additional <em>biases</em>, applying <em>mitigation measures</em></a>
  <ul class="collapse">
<li><a href="#buffalo-tracking-data-1" id="toc-buffalo-tracking-data-1" class="nav-link" data-scroll-target="#buffalo-tracking-data-1">5.1. Buffalo tracking data</a></li>
  <li><a href="#gazelle-tracking-data-1" id="toc-gazelle-tracking-data-1" class="nav-link" data-scroll-target="#gazelle-tracking-data-1">5.2. Gazelle tracking data</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">How to estimate home ranges</h1>
  <div class="quarto-categories">
    <div class="quarto-category">movement ecology</div>
    <div class="quarto-category">home range</div>
  </div>
  </div>

<div>
  <div class="description">
    Guide to autocorrelated home range estimation using <code>R</code>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Inês Silva </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><p>This tutorial is a companion piece to a manuscript titled <strong><em>“Autocorrelation-informed home range estimation: a review and practical guide”</em></strong>. Manuscript was published in <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13786">Methods in Ecology and Evolution</a>. Preprint is also available on <a href="https://ecoevorxiv.org/repository/view/4026/">EcoEvoRxiv</a>. For any definitions, check the main manuscript or the [<em>Glossary</em>].</p>
<p><em>To cite this material:</em></p>
<blockquote class="blockquote">
<p>Silva, I., Fleming, C. H., Noonan, M. J., Alston, J., Folta, C., Fagan, W. F., &amp; Calabrese, J. M. (2022). Autocorrelation‐informed home range estimation: A review and practical guide. Methods in Ecology and Evolution, 13(3), 534-544.</p>
</blockquote>
<section id="introduction" class="level1 page-columns page-full"><h1>Introduction</h1>
<p><strong><em>Home range</em></strong> estimation is a key output from animal tracking datasets, but the inherent properties of animal movement can lead traditional methods to under- or overestimated their size. <strong>Autocorrelated Kernel Density Estimation (AKDE)</strong> methods were designed to be statistically efficient while explicitly dealing with the complexities and biases of modern movement data, such as <em>autocorrelation</em>, <em>small sample sizes</em>, and <em>missing or irregularly sampled data</em>.</p>
<aside><em>Home range</em>: the area repeatedly used throughout an animal’s lifetime for all its normal behaviors and activities, excluding occasional exploratory moves.
</aside><p>The <strong>AKDE</strong> family of home range estimators will be run using <strong>R software</strong> (<a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a>) and the <code>ctmm</code> package <span class="citation" data-cites="calabrese_ctmm_2016">(<a href="#ref-calabrese_ctmm_2016" role="doc-biblioref">Calabrese et al., 2016</a>)</span>. The techniques and mitigation measures available within this package include:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">Method</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">When.to.run.</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">What.does.it.do.</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">R.function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AKDE</td>
<td style="text-align: left;">Tracking data is autocorrelated</td>
<td style="text-align: left;">Estimates range distributions from autocorrelated data, by conditioning on an autocorrelation model.</td>
<td style="text-align: left; font-family: monospace;">akde(, debias = FALSE)</td>
</tr>
<tr class="even">
<td style="text-align: left;">AKDEc</td>
<td style="text-align: left;">If using GRF-based KDEs (such as AKDE)</td>
<td style="text-align: left;">Removes the tendency of Gaussian reference function (GRF) methods to overestimate the area of home ranges.</td>
<td style="text-align: left; font-family: monospace;">akde(, debias = TRUE)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pHREML</td>
<td style="text-align: left;">Small (absolute and effective) sample sizes</td>
<td style="text-align: left;">Improves upon ML and REML autocorrelation estimation, mitigating small sample size biases.</td>
<td style="text-align: left; font-family: monospace;">ctmm.select(, method = "pHREML")</td>
</tr>
<tr class="even">
<td style="text-align: left;">wAKDEc</td>
<td style="text-align: left;">Irregular sampling schedules or missing data</td>
<td style="text-align: left;">Upweights observations that occur during under-sampled times, while downweighting those occurring during over-sampled times.</td>
<td style="text-align: left; font-family: monospace;">akde(, weights = TRUE)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Parametric bootstrap</td>
<td style="text-align: left;">Extremely small effective sample size</td>
<td style="text-align: left;">Calculates and corrects for autocorrelation estimation biases, by simulating from an approximate sampling distribution.</td>
<td style="text-align: left; font-family: monospace;">ctmm.boot(...)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>AKDE<sub>c</sub> and pHREML are default arguments within the <code><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde()</a></code> and <code><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select()</a></code> functions, respectively. Both measures will run automatically if arguments <code>debias</code> and <code>method</code> are left unspecified. For most situations, we recommend keeping both of these arguments as the default.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Installing &amp; loading package:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ctmm"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctmm-initiative/ctmm">ctmm</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section><section id="data-preparation" class="level1 page-columns page-full"><h1>Data Preparation</h1>
<p>We will use two datasets, both available within the <code>ctmm</code> package: African buffalos (<em>Syncerus caffer</em>), and Mongolian gazelles (<em>Procapra gutturosa</em>). Information on the data collection protocol is available in Cross <em>et al.</em> <span class="citation" data-cites="cross_disease_2009">(<a href="#ref-cross_disease_2009" role="doc-biblioref">2009</a>)</span> and Fleming <em>et al.</em> <span class="citation" data-cites="fleming_fine-scale_2014">(<a href="#ref-fleming_fine-scale_2014" role="doc-biblioref">2014</a>)</span>. The <code>ctmm</code> package requires data to conform to Movebank naming conventions (<a href="https://www.movebank.org/node/2381" class="uri">https://www.movebank.org/node/2381</a>). We recommend uploading your data to Movebank (<a href="http://www.movebank.org/" class="uri">http://www.movebank.org/</a>) as this will facilitate data preparation, and ensure that your data are correctly formatted for <code>ctmm</code>. If needed, Movebank allows you to keep your data private.</p>
<p>We will focus on the simplest data structure:</p>
<ul>
<li>
<code>animal ID</code> or <code>ID</code> — An individual identifier for each animal tracked;</li>
<li>
<code>timestamp</code> or <code>t</code> — The date and time corresponding to a sensor measurement;
<ul>
<li>
<strong>Example</strong>: 2021-01-01 18:31:00.000
<ul>
<li>
<strong>Format</strong>: yyyy-MM-dd HH:mm:ss.SSS</li>
</ul>
</li>
</ul>
</li>
<li>
<code>longitude</code> or <code>x</code> — The geographic longitude of the location as estimated by the sensor;
<ul>
<li>
<strong>Example</strong>: -121.1761111
<ul>
<li>
<strong>Units</strong>: decimal degrees, WGS84 reference system.</li>
</ul>
</li>
</ul>
</li>
<li>
<code>latitude</code> or <code>y</code> — The geographic latitude of the location as estimated by the sensor;
<ul>
<li>
<strong>Example</strong>: -41.0982423
<ul>
<li>
<strong>Units</strong>: decimal degrees, WGS84 reference system.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Location can also be described as UTM locations instead of latitude/longitude. In this case, you should provide <code>UTM easting</code>, <code>UTM northing</code>, and <code>UTM zone</code>. For all terms and conventions, please see the full vocabulary list here: <a href="http://vocab.nerc.ac.uk/collection/MVB/current/" class="uri">http://vocab.nerc.ac.uk/collection/MVB/current/</a>.</p>
<section id="step-1.-formatting-and-loading-an-animal-tracking-dataset" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="step-1.-formatting-and-loading-an-animal-tracking-dataset">
<strong>Step 1.</strong> Formatting and loading an animal tracking dataset</h2>
<p>You can import data into R through the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> or <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> functions; make sure to navigate to the appropriate folder or working directory. You can find two example files within the GitHub repository <a href="https://github.com/ecoisilva/AKDE_minireview/tree/main/data">data folder</a>. To read these .csv files into R:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"here"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># your working directory</span></span>
<span></span>
<span><span class="co"># First, list all files in a specific folder:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="co"># verify that your file appears here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Then load the file:</span></span>
<span><span class="va">animal0_longlat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"blog-posts/data/example_data_longlat.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">animal0_longlat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID        timestamp longitude latitude
1 animal0 2005-07-14 05:35  30.59648 65.24774
2 animal0 2005-07-14 07:35  30.53256 65.27085
3 animal0 2005-07-14 08:34  30.52398 65.26446
4 animal0 2005-07-14 09:35  30.52848 65.25948
5 animal0 2005-07-14 10:35  30.53382 65.26643
6 animal0 2005-07-14 11:34  30.49970 65.27868</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># or:</span></span>
<span><span class="va">animal0_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"blog-posts/data/example_data_utm.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">animal0_utm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID        timestamp UTM.Easting UTM.Northing  UTM.zone
1 animal0 14/07/2005 05:35    387730.0      7238204 36 +north
2 animal0 14/07/2005 07:35    384846.3      7240894 36 +north
3 animal0 14/07/2005 08:34    384418.1      7240197 36 +north
4 animal0 14/07/2005 09:35    384606.5      7239634 36 +north
5 animal0 14/07/2005 10:35    384885.8      7240399 36 +north
6 animal0 14/07/2005 11:34    383347.9      7241826 36 +north</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Finally, convert to telemetry object:</span></span>
<span><span class="va">animal0a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/as.telemetry.html">as.telemetry</a></span><span class="op">(</span><span class="va">animal0_longlat</span><span class="op">)</span></span>
<span><span class="va">animal0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/as.telemetry.html">as.telemetry</a></span><span class="op">(</span><span class="va">animal0_utm</span><span class="op">)</span></span>
<span><span class="co"># if left unspecified, as.telemetry() will assume timezone = UTC, datum = WGS84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Both these files represent the same individual, with either <em>longitude</em>/<em>latitude</em>, or UTM coordinates (<em>easting</em>, <em>northing</em>, and <em>zone</em>), and both outputs —<code>animal0a</code> and <code>animal0b</code>— will show the same coordinates after conversion. In general, the <code><a href="https://rdrr.io/pkg/ctmm/man/as.telemetry.html">as.telemetry()</a></code> function will immediately identify the columns if they are correctly named, convert the projection if needed, and then output the minimum sampling interval for each individual in the dataset. In this example, <code>animal0</code> has a minimum sampling interval of 59 minutes.</p>
<section id="buffalo-tracking-data" class="level3"><h3 class="anchored" data-anchor-id="buffalo-tracking-data">1.1. Buffalo tracking data</h3>
<p>For this tutorial, we will use data already prepared into a list of <code>telemetry</code> objects. We can load it directly from the <code>ctmm</code> R package with the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"buffalo"</span><span class="op">)</span></span>
<span><span class="va">animal1_buffalo</span> <span class="op">&lt;-</span> <span class="va">buffalo</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="co"># selecting individual number 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">animal1_buffalo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                timestamp longitude  latitude          t         x         y
17517 2006-04-25 05:09:00  31.73749 -24.19705 1145941740 -51803.35 -2715.663
17518 2006-04-25 06:09:00  31.73653 -24.19929 1145945340 -51569.29 -2845.660
17519 2006-04-25 07:09:00  31.73946 -24.20100 1145948940 -51340.72 -2576.353
17520 2006-04-25 08:09:00  31.73987 -24.20092 1145952540 -51344.11 -2533.788
17521 2006-04-25 10:09:00  31.74086 -24.20365 1145959740 -51029.45 -2474.771
17522 2006-04-25 11:09:00  31.74098 -24.20370 1145963340 -51022.23 -2463.655</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plotting locations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal1_buffalo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="blog-post-1_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="blog-post-1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This dataset showcases an irregular sampling schedule: the buffalo nicknamed <em>“Pepper”</em> had a sampling rate shift from one fix every hour to one fix every two hours. We will use this dataset to highlight data irregularity and the <strong>wAKDE</strong> mitigation measure.</p>
</section><section id="gazelle-tracking-data" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="gazelle-tracking-data">1.2. Gazelle tracking data</h3>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"gazelle"</span><span class="op">)</span></span>
<span><span class="va">animal2_gazelle</span> <span class="op">&lt;-</span> <span class="va">gazelle</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span> <span class="co"># selecting individual number 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">animal2_gazelle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             x          y       t
2742  18152.70  -8539.799       0
2743  15931.16 -32069.788 1306800
2744  17678.84 -28632.329 1396800
2745  23135.50 -23820.789 1486800
2746 -20310.78  20348.792 2419200
2747 -17920.31  20598.668 2509200</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plotting locations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal2_gazelle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="blog-post-1_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="blog-post-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<aside><em>Home range crossing time</em>: the time required for an animal to cross the linear extent of its home range.
</aside><p>Mongolian gazelles have a <strong><em>home range crossing time</em></strong> of a few months, and with a maximum longevity around 10 years, it is impossible to get a considerable <strong><em>effective sample size</em></strong> no matter the study duration <span class="citation" data-cites="fleming_overcoming_2019">(<a href="#ref-fleming_overcoming_2019" role="doc-biblioref">Fleming et al., 2019</a>)</span>. We will use this dataset to highlight how to check <strong><em>effective sample size</em></strong> and apply the <strong>parametric bootstrap</strong> mitigation.</p>
<aside><em>Effective sample size (N)</em>: number of range crossings that occurred during the observation period. Can be roughly estimated by dividing the duration of the tracking dataset by the average home range crossing time parameter.
</aside><hr></section></section></section><section id="data-analysis" class="level1 page-columns page-full"><h1>Data Analysis</h1>
<section id="step-2.-checking-for-the-range-residency-assumption" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="step-2.-checking-for-the-range-residency-assumption">
<strong>Step 2.</strong> Checking for the <em>range residency</em> assumption</h2>
<p>First, we want to check if our first tracking dataset (<code>animal1_buffalo</code>) can be used for home range estimation by checking for <strong><em>range residency</em></strong>. To achieve this, we calculate the <strong>semi-variance function (SVF)</strong>, and visualize it through the <code><a href="https://rdrr.io/pkg/ctmm/man/variogram.html">variogram()</a></code> function.</p>
<aside><em>Range residency</em>: the tendency of an animal to remain within their home range.
</aside><p><strong>Variograms</strong> are an unbiased way to visualize <em>autocorrelation</em> structure, representing the average square displacement (y-axis) over a specific time lag (x-axis). To facilitate interpretation, we have the <strong>SVF</strong> of <code>animal1_buffalo</code> zoomed out (right) to showcase all time lags and (left) zoomed in to showcase time lags up to two months:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fl">0.95</span> <span class="co"># we want to display 95% confidence intervals</span></span>
<span><span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span> <span class="op"><a href="https://rdrr.io/pkg/ctmm/man/unit.html">%#%</a></span> <span class="st">"month"</span><span class="op">)</span> <span class="co"># to create a window of 2 months</span></span>
<span></span>
<span><span class="va">SVF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/variogram.html">variogram</a></span><span class="op">(</span><span class="va">animal1_buffalo</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">SVF</span>, fraction <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="va">level</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># adding a line at 1 month </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">SVF</span>, xlim <span class="op">=</span> <span class="va">xlim</span>, level <span class="op">=</span> <span class="va">level</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="blog-post-1_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="blog-post-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We can see that the variogram flattens (<em>i.e.</em>, reaches an asymptote) after approximately <strong>1 month</strong> (<span style="color: red;">red</span> line). This also indicates at how coarse the timeseries needs to be to assume independence (no autocorrelation), and corresponds to when traditional methods —such as <strong>minimum convex polygons (MCPs)</strong> and <strong>Kernel Density Estimators (KDEs)</strong>— could be applied without violating their assumptions.</p>
</section><section id="step-3.-selecting-the-best-fit-movement-model-through-model-selection" class="level2"><h2 class="anchored" data-anchor-id="step-3.-selecting-the-best-fit-movement-model-through-model-selection">
<strong>Step 3.</strong> – Selecting the best-fit movement model through <em>model selection</em>
</h2>
<p>It is necessary to choose a home range estimator that accounts for the autocorrelated structure of the data, now that we see that it is <strong>not</strong> independently and identically distributed (non-IID). We need to test what movement model may explain the autocorrelated structure of our tracking data. We can run different movement processes with <strong>maximum likelihood (ML)</strong> or other parameter estimators, such as <strong>perturbative Hybrid REML (pHREML)</strong>. To facilitate further comparisons, we will run both ML and pHREML with the <code>ctmm.select</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate an automated model guesstimate:</span></span>
<span><span class="va">GUESS1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/variogram.fit.html">ctmm.guess</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Automated model selection, starting from GUESS:</span></span>
<span><span class="va">FIT1_ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">GUESS1</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span>
<span><span class="va">FIT1_pHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">GUESS1</span>, method <span class="op">=</span> <span class="st">'pHREML'</span><span class="op">)</span></span>
<span><span class="co">## reminder: it will default to pHREML if no method is specified.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">FIT1_ML</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">FIT1_pHREML</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Within these summaries, <code>$name</code> provides the selected best-fit model, <code>$DOF</code> provides information on the degrees of freedom (where <code>$DOF["area"]</code> corresponds to the <strong><em>effective sample size</em></strong> of the home-range area estimate), and <code>$CI</code> are the parameter outputs (area, position autocorrelation timescale, velocity autocorrelation timescale, and speed).</p>
<p>The typical pool of candidate models includes isotropic (when diffusion is the same in every direction; symmetrical) and anisotropic (when diffusion varies with direction; asymmetrical) variants. The automated model selection shows that <em>OUF anisotropic</em> (anisotropic Ornstein-Uhlenbeck foraging process) is our best-fit model. This movement process features a home range, correlated positions, and correlated velocities. To check the full model selection table, we can run the following command:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FIT1_pHREML_verbose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">GUESS1</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">FIT1_pHREML_verbose</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By adding the argument <code>verbose = TRUE</code> we have access to the model selection table. By default, model selection is based on <em>Akaike’s Information Criterion adjusted for small sample sizes</em> (AICc). The <code>ctmm</code> package also offers BIC, LOOCV, and HSCV. LOOCV seems to work slightly better for very small datasets, but we recommend AICc for the majority of datasets.</p>
</section><section id="step-4.-feeding-a-movement-model-into-the-home-range-estimator" class="level2"><h2 class="anchored" data-anchor-id="step-4.-feeding-a-movement-model-into-the-home-range-estimator">
<strong>Step 4.</strong> Feeding a movement model into the <em>home range estimator</em>
</h2>
<p>Now we can fit this movement process into the <code><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde()</a></code> function, and estimate the home range of <code>animal1_buffalo</code>. This function currently defaults to the <strong>area-corrected AKDE</strong>, or <strong>AKDEc</strong> (Fleming &amp; Calabrese 2017):</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run an area-corrected AKDE:</span></span>
<span><span class="va">UD1_ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">FIT1_ML</span><span class="op">)</span></span>
<span><span class="va">UD1_pHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">FIT1_pHREML</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD1_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span> <span class="co"># home range area estimation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have calculated our home range for <code>animal1_buffalo</code>, resulting in an estimation of 757 km<sup>2</sup> (with 95% confidence intervals: 430–1,175 km<sup>2</sup>).</p>
</section><section id="step-5.-evaluating-additional-biases-applying-mitigation-measures" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="step-5.-evaluating-additional-biases-applying-mitigation-measures">
<strong>Step 5.</strong> Evaluating additional <em>biases</em>, applying <em>mitigation measures</em>
</h2>
<section id="buffalo-tracking-data-1" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="buffalo-tracking-data-1">5.1. Buffalo tracking data</h3>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD1_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">DOF</span><span class="op">[</span><span class="st">"area"</span><span class="op">]</span> <span class="co"># effective sample size of animal1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    area 
15.65773 </code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">animal1_buffalo</span><span class="op">)</span> <span class="co"># absolute sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1725</code></pre>
</div>
</div>
<p>Our output here also reveals more information regarding our dataset: the <strong><em>effective sample size (N)</em></strong> and the <strong><em>absolute sample size (</em>n<em>)</em></strong>. We can return this measure with the <code>summary</code> function: in our case, the <em>N</em> for <code>animal1_buffalo</code> is 15.7. Comparatively, our <strong><em>absolute sample size</em></strong> is easy to output, as it is the total number of observations within our dataset (<em>n</em> = 1,725).</p>
<aside><em>Absolute sample size (n)</em>: the number of observations (fixes) in a dataset.
</aside><p>As mentioned earlier, <code>animal1_buffalo</code> had a device malfunction that led GPS fixes to shift from one fix per hour, to one fix every two hours. As such, this individual is particularly suited for a <strong>weighted AKDEc</strong> (or <strong>wAKDEc</strong>), so we can re-run the function with weights set to <code>TRUE</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">UD1w_pHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, <span class="va">FIT1_pHREML</span>, weights <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD1w_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span> <span class="co"># home range area estimation (weighted)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our new home range area estimation for <code>animal1_buffalo</code> is 761 km<sup>2</sup> (with 95% confidence intervals: 432–1,182 km<sup>2</sup>). We can now plot our home range estimate for <code>animal1_buffalo</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Creating an extent that includes both UDs at the 95% CI level:</span></span>
<span><span class="va">EXT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">UD1_ML</span>, <span class="va">UD1_pHREML</span>, <span class="va">UD1w_pHREML</span><span class="op">)</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting pHREML (with and without weights) side-by-side:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, UD <span class="op">=</span> <span class="va">UD1_pHREML</span>, ext <span class="op">=</span> <span class="va">EXT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"pHREML AKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal1_buffalo</span>, UD <span class="op">=</span> <span class="va">UD1w_pHREML</span>, ext <span class="op">=</span> <span class="va">EXT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"pHREML wAKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="blog-post-1_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="blog-post-1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>For <code>animal1_buffalo</code>, the difference between model parameter estimators is not substantial; we only have a ~5.7% AKDE area underestimation by ML compared to pHREML. However, the data fits the spatial locations much better.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD1_ML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD1w_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.737587</code></pre>
</div>
</div>
</section><section id="gazelle-tracking-data-1" class="level3"><h3 class="anchored" data-anchor-id="gazelle-tracking-data-1">5.2. Gazelle tracking data</h3>
<p>We can also check the difference with <code>animal2_gazelle</code>’s tracking data, where the small <strong><em>effective sample size</em></strong> issue is clearer:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">GUESS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/variogram.fit.html">ctmm.guess</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FIT2_ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">GUESS2</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span>
<span><span class="va">FIT2_pHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.fit.html">ctmm.select</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">GUESS2</span>, method <span class="op">=</span> <span class="st">'pHREML'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UD2_ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">FIT2_ML</span><span class="op">)</span></span>
<span><span class="va">UD2_pHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">FIT2_pHREML</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With <code>animal2_gazelle</code>, we have a more substantial area underestimation by ML compared to pHREML (~15.2%). We can also see that our <strong><em>effective sample size</em></strong> is only 4.5, with an <strong><em>absolute sample size</em></strong> of 49 (<em>N</em> <span class="math inline">\(\ll\)</span> <em>n</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD2_ML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD2_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.16696</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD2_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">DOF</span><span class="op">[</span><span class="st">"area"</span><span class="op">]</span> <span class="co"># effective sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    area 
4.528926 </code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">animal2_gazelle</span><span class="op">)</span> <span class="co"># absolute sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49</code></pre>
</div>
</div>
<p>At this point, we have selected a movement process, fed it into a home range area estimation with different model parameter estimators, and corrected for irregular sampling rates. With small <strong><em>effective sample sizes</em></strong>, it is important to see if <strong>parametric bootstrapping</strong> may be worth it to further reduce our estimation error. In order to do so, we can check the expected order of bias from pHREML:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Expected order of pHREML bias:</span></span>
<span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">FIT2_pHREML</span><span class="op">)</span><span class="op">$</span><span class="va">DOF</span><span class="op">[</span><span class="st">'area'</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      area 
0.04875393 </code></pre>
</div>
</div>
<p>The bias is currently <span class="math inline">\(\mathcal{O}(5\%)\)</span> (“in the order of” 5%). As such, we will run parametric bootstrapping for <code>animal2_gazelle</code>. The relative error target is 1% by default (<code>argument error = 0.01</code>), but can be adjusted if necessary.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># start recording running time</span></span>
<span><span class="va">BOOT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/ctmm.boot.html">ctmm.boot</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">FIT2_pHREML</span>, trace <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">## note: this function incurs substantial computational cost, may take hours!</span></span>
<span><span class="op">(</span> <span class="va">total_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start_time</span> <span class="op">)</span> <span class="co"># output running time</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BOOT</span><span class="op">)</span></span>
<span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BOOT</span><span class="op">)</span><span class="op">$</span><span class="va">DOF</span><span class="op">[</span><span class="st">'area'</span><span class="op">]</span><span class="op">^</span><span class="fl">3</span> <span class="co"># expected order of bias</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see that the expected order of bias was reduced to 2.3%, which is comparable to the numerical error target of 1%. To reduce the numerical error further, we would need to change the default relative error target of <code>ctmm.boot</code>, but the computational cost would continue to increase, and the comparably large statistical bias (2%) would remain.</p>
<p>Now we will calculate the <strong>AKDEc</strong> based on the estimated parameters, and plot the home range of <code>animal2_gazelle</code>. Because of small <strong><em>effective sample size</em></strong>, we set optimal weights to <code>TRUE</code> for improved statistical efficiency:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">UD2_bpHREML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctmm/man/akde.html">akde</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, <span class="va">BOOT</span>, weights <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">UD2_bpHREML</span><span class="op">)</span><span class="op">$</span><span class="va">CI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we have calculated our home range for <code>animal2_gazelle</code>, with an estimated area of 13,274 square kilometers (with 95% confidence intervals: 3,231–30,280 km<sup>2</sup>). Our uncertainty with <code>animal2_gazelle</code> is substantially higher than with <code>animal1_buffalo</code>, as expected due to the small <strong><em>effective sample size</em></strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Creating an extent that includes both UDs at the 95% CI level:</span></span>
<span><span class="va">EXT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">UD2_pHREML</span>, <span class="va">UD2_bpHREML</span><span class="op">)</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting pHREML and bootstrapped-pHREML side-by-side:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, UD <span class="op">=</span> <span class="va">UD2_pHREML</span>, ext <span class="op">=</span> <span class="va">EXT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"pHREML AKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">animal2_gazelle</span>, UD <span class="op">=</span> <span class="va">UD2_bpHREML</span>, ext <span class="op">=</span> <span class="va">EXT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Bootstrapped pHREML wAKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="blog-post-1_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="blog-post-1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The results presented here were generated with <code>R</code> version <code>4.2.3</code>, and <code>ctmm</code> version <code>1.1.1</code>.</p>
<hr></section></section></section><section id="glossary" class="level1"><h1>Glossary</h1>
<p><a id="glossary"></a></p>
<p>– <em>Home range</em>: the area repeatedly used throughout an animal’s lifetime for all its normal behaviors and activities, excluding occasional exploratory moves.</p>
<p>– <em>Range residency</em>: the tendency of an animal to remain within their home range.</p>
<p>– <em>Home range crossing time</em>: the time required for an animal to cross the linear extent of its home range.</p>
<p>– <em>Absolute sample size</em> (<em>n</em>): the number of observations (fixes) in a dataset.</p>
<p>– <em>Effective sample size</em> (<em>N</em>): number of range crossings that occurred during the observation period. Can be roughly estimated by dividing the duration of the tracking dataset by the average <em>home range crossing time</em> parameter.</p>
</section><section id="references" class="level1">



</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-calabrese_ctmm_2016" class="csl-entry" role="listitem">
Calabrese, J. M., Fleming, C. H., &amp; Gurarie, E. (2016). Ctmm: <span>An</span> r package for analyzing animal relocation data as a continuous‐time stochastic process. <em>Methods in Ecology and Evolution</em>, <em>7</em>(9), 1124–1132.
</div>
<div id="ref-cross_disease_2009" class="csl-entry" role="listitem">
Cross, P. C., Heisey, D. M., Bowers, J. A., Hay, C. T., Wolhuter, J., Buss, P., Hofmeyr, M., Michel, A. L., Bengis, R. G., &amp; Bird, T. L. F. (2009). Disease, predation and demography: Assessing the impacts of bovine tuberculosis on <span>African</span> buffalo by monitoring at individual and population levels. <em>Journal of Applied Ecology</em>, <em>46</em>(2), 467–475.
</div>
<div id="ref-fleming_fine-scale_2014" class="csl-entry" role="listitem">
Fleming, C. H., Calabrese, J. M., Mueller, T., Olson, K. A., Leimgruber, P., &amp; Fagan, W. F. (2014). From fine-scale foraging to home ranges: A semivariance approach to identifying movement modes across spatiotemporal scales. <em>The American Naturalist</em>, <em>183</em>(5), E154–E167.
</div>
<div id="ref-fleming_overcoming_2019" class="csl-entry" role="listitem">
Fleming, C. H., Noonan, M. J., Medici, E. P., &amp; Calabrese, J. M. (2019). Overcoming the challenge of small effective sample sizes in home‐range estimation. <em>Methods in Ecology and Evolution</em>, <em>10</em>(10), 1679–1689.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ecoisilva\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="ecoisilva/ecoisilva.github.io" issue-term="title" theme="body-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Inês Silva 2025 ∙ Made with <a href="https://quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../contact.html">
<p><i class="fa-solid fa-envelope" aria-label="envelope"></i> Contact me</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>